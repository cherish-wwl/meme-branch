<%@ page language="java" import="java.util.*,com.meme.core.cache.ParamsCache" pageEncoding="UTF-8"%>

<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
<%@ taglib uri="http://www.mmgmmj.com/jsp/jstl/tag" prefix="express"%>
<%@ taglib uri="http://www.mmgmmj.com/jsp/jstl/functions" prefix="expressFunc"%>
<%
	String basePath = request.getScheme() + "://" + request.getServerName() + (request.getServerPort()!=80?(":"+request.getServerPort()):"") + request.getContextPath() +"/";
%>
<script type="text/javascript">
	window.GLOBAL_BASE_PATH = "<%=basePath%>";
</script><!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=320,  maximum-scale=1, user-scalable=no" />
<meta name="screen-orientation" content="portrait" />
<meta name="x5-orientation" content="portrait" />
<title>发布栏目内容-么么社区</title>
<link rel="icon" href="http://img.bj.wezhan.cn/2040385_favicon.ico?t=201707160105051476" />
<link rel="shortcut icon" href="http://img.bj.wezhan.cn/2040385_favicon.ico?t=201707160105051476" />
<link rel="bookmark" href="http://img.bj.wezhan.cn/2040385_favicon.ico?t=201707160105051476" />
<meta name="description" content="" />
<meta name="keywords" content="" />
<link rel="stylesheet" href="http://1281095212.bj.wezhan.cn/Plugins/Designer/Content/css/base.mobile.css" type="text/css" />
<link rel="stylesheet" href="http://1281095212.bj.wezhan.cn/RunTime/RenderRunTimeCss?cid=%2Fcontent%2Fsitefiles2040%2F2040385%2Fcss%2Fmobile%2F277602326_zh-CN.prev.css%3Fdt%3D636357639051163950" type="text/css" />
<script type="text/javascript" src="http://img.bj.wezhan.cn/Plugins/Designer/Script/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="http://img.bj.wezhan.cn/Plugins/Designer/Script/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="http://img.bj.wezhan.cn/Scripts/public.common.min.js"></script>
<script type="text/javascript" src="http://img.bj.wezhan.cn/Plugins/Designer/Script/jquery.lazyload.min.js"></script>
<script type="text/javascript" src="http://img.bj.wezhan.cn/Scripts/underscore-min.js"></script>
<link href="http://img.bj.wezhan.cn/Plugins/Designer/Content/css/iconfontV2.css" rel="stylesheet" />
<link href="http://1281095212.bj.wezhan.cn/Plugins/Designer/Content/css/base/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link href="http://img.bj.wezhan.cn/Plugins/Designer/Content/css/mobile/iconfont.css" rel="stylesheet" />
<link href="http://img.bj.wezhan.cn/Plugins/Designer/Content/mw-iconfont/iconfont.css" rel="stylesheet" />
<script type="text/javascript" src="http://img.bj.wezhan.cn/Plugins/Designer/Script/YM.Animation.mobile.min.js"></script>
<script language='javascript' type='text/javascript' id='yibuHeaderScript'></script>
<script type="text/javascript" src="http://img.bj.wezhan.cn/Scripts/jquery.validatestar.min.js"></script>
<link rel="stylesheet" href="<%=basePath%>static/layui/css/layui.css">
<link rel="stylesheet" href="<%=basePath%>static/js/jquery_mobile/jquery.mobile-1.4.5.css">
<script src="<%=basePath%>static/js/jquery_mobile/jquery.mobile-1.4.5.js" type="text/javascript"></script>
<script src="<%=basePath%>static/layui/layui.js"></script>
<style>
        ::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }

        ::-webkit-scrollbar-track-piece {
            background-color: #EEE;
            -webkit-border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:vertical {
            height: 3px;
            background-color: #BBBBBB;
            -webkit-border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:horizontal {
            width: 3px;
            background-color: #EEE;
            -webkit-border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            height: 3px;
            background-color: #AAAAAA;
            -webkit-border-radius: 4px;
        }

        html {
            overflow-x: hidden;
        }
    </style>
</head>
<body style="overflow-x: hidden;">
<div data-role="header">
	<a href="http://mmgmmj.com/zybj" class="ui-btn ui-corner-all ui-shadow ui-icon-home ui-btn-icon-left" data-ajax="false">返回</a>
	<h1>更新栏目内容</h1>
</div>
<input type="hidden" id="hid_siteId" value="2040385" data-role="none"/>
<input type="hidden" id="hid_pageId" data-role="none"/>
<input type="hidden" id="hid_pageType" value="0" data-role="none"/>
<input type="hidden" id="pageinfo" value="277602326" data-type="" data-device="mobile" data-entityid="" data-role="none"/>
<div  id="view_main_1_277602326" class="mainSamrtView yibuSmartViewMargin" data-role="none">
  <div class='yibuFrameContent main__Item0' style='height:461px;width:100%;' data-role="none">
    <div class='runTimeflowsmartView' data-role="none">
      <div  id="view_v2code_17_277602326" class="yibuSmartViewMargin absPos" data-role="none">
        <div class='yibuFrameContent v2code_Style1_Item0 view_v2code_17_277602326_Style1_Item0' data-role="none">
          <div id='view_v2code_17_277602326_code'   style="text-align:left" data-role="none">
            <style>  
   .ai {
   position:absolute;
   margin-top:2px; 
   margin-left:20px;
   font-size:12px;
   color: #575757; }
   .bi {
   position:absolute; 
   margin-left:40px;
   margin-top:38px;
   font-size:12px;
   color:#4d4d4d; }
   .ci {
    position:absolute; 
    margin-left:36px; 
    margin-top:60px; 
    font-size:12px; 
    color: #525252; 
    width:74px; height:22px; }
   .di {
    position:absolute; 
    margin-left:37px; 
    margin-top:61px; 
    font-size:12px; 
    color: #525252; 
    width:54px; height:20px; 
    display:none;
    border: 1px solid #fff;}
   .ei {
   position:absolute; 
   top:108px;  
   width:100%;  
   height:6px;           
   border:none; 
   background-color: #f5f5f5;}
  .fi {
   position:absolute; 
   margin-top:146px; 
   margin-left:166px;
    font-size:10px; 
   color: #575757;}
  .gi {
   position:absolute; 
   margin-top:-2px;
   margin-left:-18px;}
  .hi {
   position:absolute; 
   margin-left:36px; 
   margin-top:206px;
   font-size:13px; 
   width:134px;
   height:27px;   
   border:1px solid #a6a6a6}
  .ii {
   position:absolute; 
   margin-left:36px;
   margin-top:328px; 
   font-size:13px;
   width:244px; height:27px; }
   .ji {
   position:absolute;
   margin-top:366px; 
   margin-left:36px;
   font-size:10px;
   color: #575757;
   width:246px;
   text-indent:2em;
   display:none;}
.a-sc {
    position: absolute;
    padding: 4px 10px;
    margin-top: 206px;
    margin-left: 36px;
    width:112px;
    height: 17px;
    overflow: hidden;
    line-height: 20px;
    color: #888;
    background: #fafafa;
    border: 1px solid #b0b0b0;
    border-radius: 0px;
    display: inline-block;
}
.a-sc input {
    position: absolute;
    font-size: 10px;
    left: 2px;
    top: 3px;
   }
.a-sc:hover {
    background: #D0EEFF;
    border-color: #99D3F5;
    text-decoration: none;
}
</style>
<script type="text/javascript">
function changeInputType(){
	var ctype=$('#ctype').val();
	var file_type='';
	var ctype_txt=$('select[id="ctype"] option:selected').text();
	$('#cover_val').empty();
	switch(ctype){
		case '1':
			$('#cover_txt').text(ctype_txt+'封面附图');
			$('#cover_val').append('<input type="file" name="cover" id="cover" accept="image/*" data-role="none">');
			file_type='audio/*';
			$('#img_tips').hide();
			break;
		case '2':
			$('#cover_txt').text(ctype_txt+'封面附图');
			$('#cover_val').append('<input type="file" name="cover" id="cover" accept="image/*" data-role="none">');
			file_type='video/*';
			$('#img_tips').hide();
			break;
		case '3':
			$('#cover_val').append('<input id="extlink" class="hi" type="text" name="extlink" style="margin-top:-4px;margin-left:-3px;width:96px;" data-role="none"/>');
			$('#cover_txt').text(ctype_txt+'跳转链接');
			$('#img_tips').show();
			file_type='image/*';
			break;
		case '4':
			$('#cover_val').append('<input id="extlink" class="hi" type="text" name="extlink" style="margin-top:-4px;margin-left:-3px;width:96px;" data-role="none"/>');
			$('#cover_txt').text(ctype_txt+'跳转链接');
			$('#img_tips').show();
			file_type='image/*';
			break;
	}
	$('#ctype_name').text('上传'+ctype_txt+'文件');
	$('#bz_txt').text(ctype_txt+'备注文字');
	$('#title_txt').text(ctype_txt+'标题');
	$('#content').attr('accept',file_type);
}
</script>
<form enctype="multipart/form-data" id="form" data-role="none">
<input type="hidden" id="type" name="type" value="${type}" data-role="none"/>
            <!--栏目标题类型部分-->
            <!--音频文件类型-->
            <strong  class="ai" data-role="none">
            <c:if test="${type==1}">修改栏目A标题和类型：</c:if>
            <c:if test="${type==2}">修改栏目B标题和类型：</c:if>
            <c:if test="${type==3}">修改栏目C标题和类型：</c:if>
            <c:if test="${type==4}">修改栏目D标题和类型：</c:if>
            </strong>
            <p class="bi" data-role="none">栏目标题</p>
            <select id="typ" name="typ" class="ci" data-role="none">
				<c:if test="${!empty list}">
					<c:forEach items="${list}" var="item">
						<option value="${item.dictitemcode}" <c:if test="${type==item.dictitemcode }">selected="selected"</c:if>>${item.dictitemname}</option>
					</c:forEach>
				</c:if>
				<option value="">自定义</option>
			</select>
			<script type="text/javascript">
	    	$('#typ').change(function(){
				var type=$('#typ').val();
				if(type==''){
					$('#alias').show('slow');
				}else{
					window.location.href='<%=basePath%>member/center/updateHobby?type='+type;
				}
	    	});
	    	</script>
            <p class="bi" style="margin-left:188px;" data-role="none">文件类型</p>
            <express:SelectTag attributes="{'data-role':'none'}" id="ctype" name="ctype" type="select" selected="${ctype}" dictGroupCode="ARTICLE_CONTENT_TYPE" cssClass="ci" cssStyle="margin-left:186px;"/>
            <input data-role="none" id="alias" name="alias" class="di" type="text" autofocus/>
            <hr class="ei" data-role="none"/>
            <script type="text/javascript">
   			$('#ctype').change(function(){
   				changeInputType();
   			});
   			</script>
            <!--栏目内容部分-->
            <strong class="ai" style="margin-top:144px;" data-role="none">
            <c:if test="${type==1}">更新栏目A内容：</c:if>
            <c:if test="${type==2}">更新栏目B内容：</c:if>
            <c:if test="${type==3}">更新栏目C内容：</c:if>
            <c:if test="${type==4}">更新栏目D内容：</c:if>
            </strong>
            <p id="ctype_name" class="bi" style=" margin-top:182px;" data-role="none">上传音频文件</p>
            <a id="con" href="javascript:;" class="a-sc" data-role="none">
            	<c:choose>
            	<c:when test="${ctype=='1'}"><input type="file" name="content" id="content" value="" accept="audio/*" data-role="none"></c:when>
            	<c:when test="${ctype=='2'}"><input type="file" name="content" id="content" value="" accept="video/*" data-role="none"></c:when>
            	<c:when test="${ctype=='3'}"><input type="file" name="content" id="content" value="" accept="image/*" data-role="none"></c:when>
            	<c:when test="${ctype=='4'}"><input type="file" name="content" id="content" value="" accept="image/*" data-role="none"></c:when>
            	</c:choose>
            </a>
            <p id="title_txt" class="bi" style="position:absolute; margin-left:188px; margin-top:182px;" data-role="none">音频标题</p>
            <input name="title" id="title" class="hi" type="text" style="margin-left:184px; width:96px; " data-role="none"/>
            
            <p id="bz_txt" class="bi" style="margin-top:248px;" data-role="none">音频备注文字</p>
            <input name="summary" id="summary" class="hi" type="text" style="margin-top:272px;" data-role="none"/>
            
            <p id="cover_txt" class="bi" style="margin-left:188px; margin-top:248px;" data-role="none">音频封面附图</p>
            <a id="cover_val" href="javascript:;" class="a-sc" style="margin-left:184px; margin-top:272px; width:73px;" data-role="none">
            <input type="file" name="cover" id="cover" accept="image/*" data-role="none">
            </a>
            
            <%--
            <input  id="l0" class="hi" type="text" name="" style="margin-top:272px; margin-left:184px; width:96px; display:none;"/>
            --%>
            <input class="ii" id="publish" type="button" value="确认提交" data-role="none"/>
            <%--
            <!--视频文件类型-->
            <p id="d1" class="bi" style=" margin-top:182px; display:none;">上传视频文件</p>
            <p  id="f1" class="bi" style="position:absolute; margin-left:188px; margin-top:182px; display:none;">视频标题</p>
            <p  id="h1" class="bi" style="margin-top:248px; display:none;">视频备注文字</p>
            <p  id="j1" class="bi" style="margin-left:188px; margin-top:248px; display:none;">视频封面附图</p>
            <!--图片文件类型-->
            <p id="d2" class="bi" style=" margin-top:182px; display:none;">上传图片文件</p>
            <p  id="f2" class="bi" style="position:absolute; margin-left:188px; margin-top:182px; display:none;">图片标题</p>
            <p  id="h2" class="bi" style="margin-top:248px; display:none;">图片备注文字</p>
            <p  id="j2" class="bi" style="margin-left:188px; margin-top:248px; display:none;">图片跳转链接</p>
            --%>
            <strong  id="img_tips" class="ji" data-role="none">图片跳转链接是指点击图片后，跳转的外链地址，如阅读是链接到图书阅读地址，商品是链接到详情介绍页</strong>
</form>
<script > 
$(document).ready(function(){
	changeInputType();
	$('#publish').click(function(){
		var title=$('#title').val();
		if(!title){
			layui.use('layer', function(){
				var layer=layui.layer;
				layer.msg('标题不能为空');
			});
			return ;
		}
		var type='${type}';
		var ctype=$('#ctype').val();
		var index=null;
		$.ajax({
            url: '<%=basePath%>member/center/doUpdateHobby',
            type: 'POST',
			cache: false,
			contentType: false,
			processData: false,
			beforeSend: function(){
				layui.use('layer', function(){
					var layer=layui.layer;
					index = layer.load(1, {
						shade: [0.1,'#fff']//0.1透明度的白色背景
					});
				});
			},
            data: new FormData($('#form')[0]),
            success: function(res){
				layui.use('layer', function(){
					var layer=layui.layer;
					layer.close(index);
				});
            	var data=JSON.parse(res);
				if(data.state==1) {
					window.location.href='http://mmgmmj.com/zybj';
				}else {
					layui.use('layer', function(){
						var layer=layui.layer;
						layer.msg(data.message);
					});
				}
            },
            error: function(e){
                layui.use('layer', function(){
					var layer=layui.layer;
					layer.msg('操作异常，请稍后重试或联系管理员');
				});
            }
        });
   });
});
</script>
          </div>
        </div>
      </div>
      <div  id="view_v2code_18_277602326" class="yibuSmartViewMargin absPos" data-role="none">
        <div class='yibuFrameContent overflow_hidden v2code_Style1_Item0 view_v2code_18_277602326_Style1_Item0' style='height:100px;width:320px;' data-role="none">
          <div id='view_v2code_18_277602326_code'   style="text-align:left" data-role="none"> </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="http://1281095212.bj.wezhan.cn/Scripts/jquery.cookie.js"></script>
<script type="text/javascript" src="http://img.bj.wezhan.cn/Plugins/Designer/Script/mobileAdapter.js"></script>
<script language="javascript" type="text/javascript">
        $(function () {
            mobileUtil.fixScreen();
            mobileUtil.formatUcBrowser();
            window.addEventListener("orientationchange", function (event) {
                mobileUtil.fixScreen(true);
            });
            $('.yibuAnimate').smanimate();
            $("img.lazyload").lazyload({ skip_invisible: false, effect: "fadeIn", failure_limit: 15, threshold: 100 });
            if ("True" == "False") {
                $(document.body).bind('contextmenu', function () { return false; });
            }
            var $sm_all_imgs = $('.mainSamrtView img').filter(function () {
                return !$(this).hasClass('lazyload');
            });
            if ($sm_all_imgs.length > 0) {
                $sm_all_imgs.each(function () {
                    var $this = $(this);
                    $this.bind("load", function () {
                        ReComputeVisibleSmartViewTop();
                    });
                });
            }
            ReComputeVisibleSmartViewTop();
        });
    </script>
</body>
</html>
